<!doctype html>
<html lang="es">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Xoldyx Store â€” Tienda de Cuentas</title>
		<!-- Favicon -->
		<link rel="icon" type="image/x-icon" href="imagenes/icono.png">
		<link rel="apple-touch-icon" href="imagenes/icono.png">
		<link rel="shortcut icon" href="imagenes/icono.png">
		<!-- Force favicon refresh -->
		<link rel="icon" type="image/png" href="imagenes/icono.png?v=2" />
		<script src="https://cdn.tailwindcss.com"></script>
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Orbitron:wght@700&display=swap" rel="stylesheet">
			<style>
				:root{
					--accent1:#10B981; /* Verde esmeralda */
					--accent2:#94A3B8; /* Plateado */
					--bg-primary:#0F172A; /* Fondo oscuro con toque azulado */
					--text-primary:#F1F5F9; /* Texto claro */
					--glass-bg:rgba(148, 163, 184, 0.05); /* Plateado transparente */
					--glass-border:rgba(16, 185, 129, 0.1); /* Verde transparente */
				}
				body{
					font-family:Inter,system-ui,Arial;
					background:var(--bg-primary);
					color:var(--text-primary);
					background-image: linear-gradient(to bottom right, rgba(16, 185, 129, 0.05), rgba(148, 163, 184, 0.05));
				}
				.glass{
					background:linear-gradient(180deg, var(--glass-bg), rgba(16, 185, 129, 0.02));
					border:1px solid var(--glass-border);
					border-radius:12px;
					backdrop-filter:blur(12px);
					box-shadow:0 4px 6px rgba(16, 185, 129, 0.05);
				}
				.brand{
					font-family:Orbitron,Inter,Arial;
					font-weight:800;
					color:var(--accent1);
					text-shadow:0 0 15px rgba(16, 185, 129, 0.3);
				}
				.accent-btn{
					background:linear-gradient(90deg,var(--accent1),var(--accent2));
					box-shadow:0 10px 30px rgba(16, 185, 129, 0.2);
					border:1px solid rgba(16, 185, 129, 0.1);
					transition:all 0.3s ease;
				}
				.accent-btn:hover {
					transform:translateY(-2px);
					box-shadow:0 15px 30px rgba(16, 185, 129, 0.3);
				}
				.product-img{
					height: 120px; /* ImÃ¡genes mÃ¡s grandes */
					width: auto;
					object-fit: contain;
					filter:drop-shadow(0 10px 30px rgba(16, 185, 129, 0.2));
					transition:all .3s ease;
					margin: 1rem auto;
				}
				/* Ajuste responsivo para las imÃ¡genes */
				@media (max-width: 768px) {
					.product-img {
						height: 100px;
					}
				}
				@media (max-width: 480px) {
					.product-img {
						height: 80px;
					}
				}
				.product-card:hover .product-img{
					transform:translateY(-6px) scale(1.05);
					filter:drop-shadow(0 15px 40px rgba(16, 185, 129, 0.3));
				}
				.product-card {
					transition: all 0.3s ease;
					border: 1px solid rgba(16, 185, 129, 0.1);
				}
				.product-card:hover {
					border-color: rgba(16, 185, 129, 0.3);
					transform: translateY(-2px);
				}
				.muted{color:#94A3B8}
				input, select, textarea {
					background: rgba(15, 23, 42, 0.8) !important;
					border: 1px solid rgba(16, 185, 129, 0.2) !important;
					transition: all 0.3s ease !important;
				}
				input:focus, select:focus, textarea:focus {
					border-color: var(--accent1) !important;
					box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.1) !important;
					outline: none !important;
				}

				/* Animations */
				@keyframes fadeInUp { from { opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }
				@keyframes neonGlow { 0%{text-shadow:0 0 6px rgba(124,58,237,0.12);}50%{text-shadow:0 0 18px rgba(6,182,212,0.12);}100%{text-shadow:0 0 6px rgba(124,58,237,0.12);} }
				@keyframes slideInRight { from{ transform:translateX(20px); opacity:0 } to{ transform:translateX(0); opacity:1 } }

				.animate-fade{ animation: fadeInUp .45s ease forwards; }
				.glow-title{ animation: neonGlow 3s ease-in-out infinite; }
				.cart-slide{ animation: slideInRight .25s ease forwards }

				/* Carousel with animations */
				.carousel{ 
					position:relative; 
					overflow:hidden; 
					border-radius:12px;
					background: linear-gradient(to right, rgba(16, 185, 129, 0.05), rgba(148, 163, 184, 0.05));
				}
				.carousel-track{ 
					display:flex; 
					gap:12px; 
					transition:transform 0.5s cubic-bezier(.4,0,.2,1);
					padding: 1rem;
				}
				.carousel-item{ 
					min-width:280px; 
					flex:0 0 280px;
					opacity: 0;
					animation: fadeSlideIn .8s forwards;
					transform: scale(0.98);
					transition: transform 0.3s ease;
				}
				.carousel-item:hover {
					transform: scale(1);
				}
				@keyframes fadeSlideIn {
					from { opacity: 0; transform: translateY(10px); }
					to { opacity: 1; transform: translateY(0); }
				}
				.carousel-item img {
					transition: transform .3s ease;
				}
				.carousel-item:hover img {
					transform: scale(1.05);
				}
				.carousel-nav{ 
					position:absolute; 
					top:50%; 
					transform:translateY(-50%); 
					width:100%; 
					display:flex; 
					justify-content:space-between; 
					pointer-events:none;
					opacity: 0;
					transition: opacity .3s ease;
				}
				.carousel:hover .carousel-nav {
					opacity: 1;
				}
				.carousel-nav button{ 
					pointer-events:all; 
					background:rgba(124,58,237,0.2); 
					border-radius:50%; 
					width:40px; 
					height:40px; 
					border:none; 
					cursor:pointer; 
					font-size:24px; 
					color:#fff;
					transition: background-color .3s ease, transform .2s ease;
				}
				.carousel-nav button:hover {
					background:rgba(124,58,237,0.4);
					transform: scale(1.1);
				}
				/* counter bump */
				#cartCount.bump{ transform:scale(1.18); transition:transform .18s ease; }

				/* Top menu / submenu styles */
				.top-hero{ padding:18px 0; border-bottom:1px solid rgba(255,255,255,0.03); margin-bottom:18px }
				.navbar{ display:flex; align-items:center; gap:18px }
				.menu{ position:relative }
				.menu-button{ background:transparent; border:1px solid rgba(255,255,255,0.04); padding:8px 12px; border-radius:8px; cursor:pointer }
				.submenu{ position:absolute; left:0; top:calc(100% + 8px); background:rgba(7,16,36,0.9); border:1px solid rgba(255,255,255,0.04); padding:8px; border-radius:8px; min-width:220px; display:none; z-index:50 }
				.submenu.show{ display:block }
				.submenu a{ display:block; padding:6px 8px; color:#e6eef8; text-decoration:none; border-radius:6px }
				.submenu a:hover{ background:rgba(255,255,255,0.02) }

				/* Global responsive images */
				img { max-width: 100%; height: auto; }

				/* Responsive adjustments */
		@media (max-width: 640px) {
			.carousel-item {
				min-width: 180px;
				flex: 0 0 180px;
			}
			
			/* Ajustes para mÃ³viles */
			.navbar {
				flex-direction: column;
				gap: 1rem;
				padding: 1rem;
			}
			
			.glass {
				padding: 1rem !important;
			}
			
			/* Hacer los botones mÃ¡s grandes en mÃ³vil para mejor usabilidad */
			button, .accent-btn {
				padding: 0.75rem 1rem !important;
				font-size: 1rem !important;
			}
			
			/* Ajustar controles de filtros */
			#controls .flex {
				flex-direction: column;
				gap: 1rem;
			}
			
			/* Mejorar espaciado en tarjetas de productos */
			.product-card {
				padding: 1.5rem !important;
			}
			
			/* Hacer los inputs mÃ¡s grandes en mÃ³vil */
			input, select, textarea {
				padding: 0.75rem !important;
				font-size: 1rem !important;
			}
		}
		
		/* Ajustes para tablets */
		@media (min-width: 641px) and (max-width: 1024px) {
			.product-card {
				padding: 1.25rem !important;
			}
			
			.glass {
				padding: 1.25rem !important;
			}
		}
		
		/* Ajustes generales de responsividad */
		.max-w-6xl {
			width: 95%;
			margin-left: auto;
			margin-right: auto;
		}
		
		/* Mejoras en el carrito para dispositivos mÃ³viles */
		@media (max-width: 640px) {
			#cartDrawer aside {
				width: 100% !important;
			}
			
			#cartList {
				max-height: 60vh;
				overflow-y: auto;
			}
		}
			</style>
	</head>
	<body>
		<!-- Background video (place your file at videos/background.mp4) -->
		<video id="bgVideo" class="fixed inset-0 w-auto min-w-full min-h-full object-cover -z-10" autoplay muted loop playsinline>
			<source src="videos/background.mp4" type="video/mp4">
		</video>

		<style>
			/* overlay layer so content readable */
			#bgVideo{opacity:.28}
			.bg-overlay{position:fixed;inset:0;background:linear-gradient(180deg,rgba(5,6,10,0.35),rgba(5,6,10,0.6));z-index:-5}
		</style>
		<div class="bg-overlay" aria-hidden="true"></div>
		<!-- Sistema de Notificaciones -->
		<div id="notificationsBar" class="hidden">
			<div class="bg-slate-800 border-b border-emerald-500/20">
				<div class="max-w-6xl mx-auto px-4 py-3">
					<div class="flex items-center justify-between">
						<div>
							<h4 id="notificationTitle" class="font-medium"></h4>
							<p id="notificationMessage" class="text-sm text-slate-300"></p>
						</div>
						<button onclick="hideNotification()" class="text-slate-400 hover:text-slate-300">&times;</button>
					</div>
				</div>
			</div>
		</div>

		<header class="py-5 border-b border-white/6">
			<div class="max-w-6xl mx-auto px-4 flex items-center justify-between">
				<div class="flex items-center gap-4">
					<div class="w-11 h-11 rounded-xl bg-gradient-to-br from-purple-600 to-cyan-400 flex items-center justify-center text-black font-bold">X</div>
					<div>
						<div class="brand text-lg">Xoldyx Store</div>
					</div>
				</div>
				<div class="flex items-center gap-3">
							<input id="search" class="bg-[#071024] border border-white/6 rounded-xl px-3 py-2 text-sm w-64" placeholder="Buscar (ej. Netflix, Canva, VPN...)" />
							<button id="adminBtn" class="px-3 py-2 rounded-xl bg-white/5 text-sm">ðŸ‘‘</button>
							<button id="notificationsBtn" class="relative px-3 py-2 rounded-xl bg-white/5 text-sm">
								ðŸ“¨ <span id="notificationsBadge" class="absolute -top-2 -right-2 bg-emerald-500 text-white rounded-full px-2 text-xs hidden">0</span>
							</button>
							<button id="editToggle" class="px-3 py-2 rounded-xl bg-white/5 text-sm">Editar</button>
							<button id="audioToggle" class="px-3 py-2 rounded-xl bg-white/5 text-sm">â–¶ï¸Ž MÃºsica</button>
							<button id="contactBtn" class="px-3 py-2 rounded-xl bg-white/5 text-sm">Contacto</button>
							<button id="cartBtn" class="relative px-3 py-2 rounded-xl accent-btn text-black font-semibold">Carrito <span id="cartCount" class="absolute -top-2 -right-3 bg-white text-black rounded-full px-2 text-xs">0</span></button>
						</div>

						<!-- Modal de Notificaciones -->
						<div id="notificationsModal" class="fixed inset-0 hidden z-50">
							<div class="absolute inset-0 bg-black/60" style="backdrop-filter:blur(4px)"></div>
							<div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-md">
								<div class="bg-[#071024] p-6 rounded-xl">
									<div class="flex items-center justify-between mb-6">
										<h3 class="text-xl font-bold text-emerald-400">Notificaciones</h3>
										<button id="closeNotifications" class="px-3 py-1 rounded bg-white/5">âœ•</button>
									</div>
									<div id="notificationsModalList" class="space-y-4 max-h-[60vh] overflow-y-auto">
										<!-- Las notificaciones se mostrarÃ¡n aquÃ­ -->
									</div>
								</div>
							</div>
						</div>

						<!-- Contact Modal -->
						<div id="contactModal" class="fixed inset-0 hidden z-50">
							<div class="absolute inset-0 bg-black/60" style="backdrop-filter:blur(4px)"></div>
							<div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-md">
								<div class="bg-[#071024] p-6 rounded-xl">
									<div class="flex items-center justify-between mb-6">
										<h3 class="text-xl font-bold">Contacto</h3>
										<button id="closeContact" class="px-3 py-1 rounded bg-white/5">âœ•</button>
									</div>
									<div class="grid grid-cols-2 gap-4">
										<a href="https://wa.me/51907376960" target="_blank" class="flex items-center gap-3 p-3 rounded-xl glass hover:bg-white/5 transition-colors">
											<img src="https://api.iconify.design/logos/whatsapp.svg" class="w-8 h-8" alt="WhatsApp"/>
											<div class="text-sm">WhatsApp</div>
										</a>
										<a href="https://www.tiktok.com/@tu_usuario" target="_blank" class="flex items-center gap-3 p-3 rounded-xl glass hover:bg-white/5 transition-colors">
											<img src="https://api.iconify.design/logos/tiktok-icon.svg" class="w-8 h-8" alt="TikTok"/>
											<div class="text-sm">TikTok</div>
										</a>
										<a href="https://www.facebook.com/tu_usuario" target="_blank" class="flex items-center gap-3 p-3 rounded-xl glass hover:bg-white/5 transition-colors">
											<img src="https://api.iconify.design/logos/facebook.svg" class="w-8 h-8" alt="Facebook"/>
											<div class="text-sm">Facebook</div>
										</a>
										<a href="https://www.instagram.com/tu_usuario" target="_blank" class="flex items-center gap-3 p-3 rounded-xl glass hover:bg-white/5 transition-colors">
											<img src="https://api.iconify.design/skill-icons/instagram.svg" class="w-8 h-8" alt="Instagram"/>
											<div class="text-sm">Instagram</div>
										</a>
										<a href="https://t.me/tu_usuario" target="_blank" class="flex items-center gap-3 p-3 rounded-xl glass hover:bg-white/5 transition-colors">
											<img src="https://api.iconify.design/logos/telegram.svg" class="w-8 h-8" alt="Telegram"/>
											<div class="text-sm">Telegram</div>
										</a>
									</div>
								</div>
							</div>
						</div>
			</div>
		</header>

		<main class="max-w-6xl mx-auto px-4 py-10">
			<!-- Hero + Top submenu -->
			<div class="top-hero">
				<div class="navbar max-w-6xl mx-auto px-4 flex items-center justify-between">
					<div>
						<h2 class="text-2xl font-bold"></h2>
					</div>
					<div class="menu">
						<button id="accountsBtn" class="menu-button">Cuentas â–¾</button>
						<div id="accountsSubmenu" class="submenu" aria-hidden="true"></div>
					</div>
				</div>
			</div>
			<section class="mb-8 grid md:grid-cols-2 gap-8 items-center">
				<div>
					<h1 class="text-4xl font-extrabold mb-3"> <span class="text-emerald-400">Bienvenido a Xoldyx Store</span></h1>
					<p class="text-gray-300 max-w-xl">La plataforma lider en cuentas premium y cursos online.</p>
				</div>
				<div class="glass p-6">
					<p class="text-sm muted">gracias por la visita a Xoldyx Store</p>
				</div>
			</section>

			<section id="controls" class="mb-6 space-y-4">
				<div class="flex items-center justify-between flex-wrap gap-4">
					<div class="flex items-center gap-3 flex-wrap">
						<select id="filterCategory" class="bg-[#071024] border border-white/6 rounded-xl px-3 py-2 text-sm">
							<option value="">Todas las categorÃ­as</option>
							<option value="Streaming">Streaming</option>
							<option value="Cursos">Cursos</option>
							<option value="MÃ©todos">MÃ©todos</option>
						</select>
						<div class="flex items-center gap-2">
							<input type="number" id="minPrice" placeholder="Precio min" class="w-24 bg-[#071024] border border-white/6 rounded-xl px-3 py-2 text-sm" />
							<span class="text-sm">-</span>
							<input type="number" id="maxPrice" placeholder="Precio max" class="w-24 bg-[#071024] border border-white/6 rounded-xl px-3 py-2 text-sm" />
						</div>
					</div>
					<div class="flex items-center gap-3">
						<select id="sortProducts" class="bg-[#071024] border border-white/6 rounded-xl px-3 py-2 text-sm">
							<option value="">Ordenar por</option>
							<option value="price-asc">Precio: Menor a mayor</option>
							<option value="price-desc">Precio: Mayor a menor</option>
							<option value="name">Nombre</option>
						</select>
						<button id="themeToggle" class="px-3 py-2 rounded-xl bg-white/5 text-sm">ðŸŒ™ Tema</button>
					</div>
				</div>
				<div class="flex items-center justify-between">
					<div class="text-sm muted">Selecciona variante: Perfil o Cuenta completa donde aplique</div>
					<div id="activeFilters" class="flex gap-2 text-xs"></div>
				</div>
			</section>

					<section id="catalog">
						<!-- Carousel destacado -->
						<div class="mb-6">
							<h2 class="text-xl font-bold mb-3">Destacados</h2>
							<div class="carousel glass p-4" id="carousel">
								<div class="carousel-track" id="carouselTrack"></div>
								<div class="carousel-nav">
									<button id="prevCarousel" class="p-2 rounded-full bg-white/5">â€¹</button>
									<button id="nextCarousel" class="p-2 rounded-full bg-white/5">â€º</button>
								</div>
							</div>
						</div>

						<div id="productsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8"></div>
					</section>
		</main>

		<!-- Cart Drawer -->
		<div id="cartDrawer" class="fixed inset-0 hidden">
			<div id="backdrop" class="absolute inset-0 bg-black/60" style="backdrop-filter:blur(4px)"></div>
			<aside class="absolute right-0 top-0 h-full w-full sm:w-[420px] bg-[#071024] p-6">
				<div class="flex items-center justify-between mb-4">
					<h3 class="text-xl font-bold">Tu carrito</h3>
					<button id="closeCart" class="px-3 py-1 rounded bg-white/5">Cerrar</button>
				</div>
				<div id="cartList" class="space-y-3 mb-4"></div>
				<div class="border-t border-white/6 pt-4">
					<div class="space-y-2 mb-3">
						<input id="couponCode" placeholder="CÃ³digo de cupÃ³n" class="w-full bg-[#071024] border border-white/6 rounded-xl px-3 py-2 text-sm" />
						<div class="flex gap-2">
							<button id="applyCoupon" class="flex-1 py-2 rounded-xl bg-white/5 text-sm">Aplicar CupÃ³n</button>
							<button id="saveCartBtn" class="flex-1 py-2 rounded-xl bg-white/5 text-sm">Guardar Carrito</button>
						</div>
					</div>
					<div id="cartSummary" class="space-y-2 border-t border-white/6 pt-4 mb-3">
						<div class="flex items-center justify-between text-sm"><span>Subtotal</span><strong id="subtotal">S/ 0.00</strong></div>
						<div class="flex items-center justify-between text-sm text-green-400"><span>Descuento</span><strong id="discount">-S/ 0.00</strong></div>
						<div class="flex items-center justify-between text-lg font-bold"><span>Total</span><strong id="total">S/ 0.00</strong></div>
					</div>
					<div class="space-y-2">
						<label class="text-sm muted">Nombre (opcional)</label>
						<input id="buyerName" class="w-full bg-[#071024] border border-white/6 rounded-xl px-3 py-2 text-sm" placeholder="Ej: Carlos" />
						<label class="text-sm muted">Notas (opcional)</label>
						<textarea id="orderNotes" rows="3" class="w-full bg-[#071024] border border-white/6 rounded-xl px-3 py-2 text-sm" placeholder="Ej: Entregar en la noche"></textarea>
						<div class="flex gap-3">
							<label class="flex items-center gap-2"><input type="radio" name="pay" value="Yape" checked/> Yape</label>
							<label class="flex items-center gap-2"><input type="radio" name="pay" value="Plin"/> Plin</label>
							<label class="flex items-center gap-2"><input type="radio" name="pay" value="Binance"/> Binance</label>
						</div>
						<div class="flex gap-2">
						  <button id="waCheckout" class="flex-1 w-full py-3 rounded-xl accent-btn text-black font-semibold">Enviar pedido por WhatsApp</button>
						  <button id="clearCart" class="flex-1 w-full py-3 rounded-xl bg-red-600 text-black font-semibold">Vaciar carrito</button>
						</div>
					</div>
				</div>
			</aside>
		</div>

				<!-- Back to top button -->
				<button id="backToTop" class="fixed bottom-4 right-4 p-3 rounded-full accent-btn text-black shadow-lg opacity-0 transition-opacity duration-300 z-50">â†‘</button>

                <!-- FAQ Section -->
                <section class="max-w-6xl mx-auto px-4 py-12 border-t border-white/6">
                    <h2 class="text-2xl font-bold mb-8">Preguntas Frecuentes</h2>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="glass p-6">
                            <h3 class="text-lg font-semibold mb-4">Â¿CÃ³mo funciona la entrega?</h3>
                            <p class="text-sm text-gray-300">Una vez realizado el pago, recibirÃ¡s los accesos de manera inmediata a travÃ©s de WhatsApp. El proceso es rÃ¡pido y seguro.</p>
                        </div>
                        <div class="glass p-6">
                            <h3 class="text-lg font-semibold mb-4">Â¿Son cuentas garantizadas?</h3>
                            <p class="text-sm text-gray-300">SÃ­, todas nuestras cuentas tienen garantÃ­a. En caso de cualquier problema, proporcionamos reemplazo inmediato.</p>
                        </div>
                        <div class="glass p-6">
                            <h3 class="text-lg font-semibold mb-4">Â¿QuÃ© mÃ©todos de pago aceptan?</h3>
                            <p class="text-sm text-gray-300">Aceptamos Yape, Plin y Binance para tu comodidad. Los pagos son verificados al instante.</p>
                        </div>
                        <div class="glass p-6">
                            <h3 class="text-lg font-semibold mb-4">Â¿QuÃ© hacer si hay problemas?</h3>
                            <p class="text-sm text-gray-300">ContÃ¡ctanos inmediatamente por WhatsApp. Nuestro soporte estÃ¡ disponible para ayudarte y resolver cualquier inconveniente.</p>
                        </div>
                    </div>
                </section>

                <!-- Reviews Section -->
                <section class="max-w-6xl mx-auto px-4 py-12 border-t border-white/6">
                    <h2 class="text-2xl font-bold mb-8">Valoraciones de Clientes</h2>
                    <div class="grid md:grid-cols-3 gap-6">
                        <div class="glass p-6">
                            <div class="flex items-center mb-4">
                                <div class="text-yellow-400 text-xl">â˜…â˜…â˜…â˜…â˜…</div>
                                <div class="ml-2 text-sm text-gray-300">hace 2 dÃ­as</div>
                            </div>
                            <p class="text-sm text-gray-300 mb-2">"Excelente servicio, entrega inmediata y muy buena atenciÃ³n al cliente."</p>
                            <div class="text-xs text-gray-400">Carlos R.</div>
                        </div>
                        <div class="glass p-6">
                            <div class="flex items-center mb-4">
                                <div class="text-yellow-400 text-xl">â˜…â˜…â˜…â˜…â˜…</div>
                                <div class="ml-2 text-sm text-gray-300">hace 5 dÃ­as</div>
                            </div>
                            <p class="text-sm text-gray-300 mb-2">"Todo perfecto, las cuentas funcionan muy bien. Recomendado!"</p>
                            <div class="text-xs text-gray-400">MarÃ­a S.</div>
                        </div>
                        <div class="glass p-6">
                            <div class="flex items-center mb-4">
                                <div class="text-yellow-400 text-xl">â˜…â˜…â˜…â˜…â˜…</div>
                                <div class="ml-2 text-sm text-gray-300">hace 1 semana</div>
                            </div>
                            <p class="text-sm text-gray-300 mb-2">"Muy rÃ¡pida la entrega y excelente soporte cuando lo necesitÃ©."</p>
                            <div class="text-xs text-gray-400">Juan P.</div>
                        </div>
                    </div>
                </section>

                <!-- Loyalty Program -->
                <section class="max-w-6xl mx-auto px-4 py-12 border-t border-white/6">
                    <h2 class="text-2xl font-bold mb-8">Programa de FidelizaciÃ³n</h2>
                    <div class="grid md:grid-cols-3 gap-6">
                        <div class="glass p-6">
                            <h3 class="text-lg font-semibold mb-4 text-gray-300">Cliente Normal</h3>
                            <ul class="text-sm text-gray-300 space-y-2">
                                <li>â€¢ Acumula 1 punto por cada S/10 en compras</li>
                                <li>â€¢ Acceso a ofertas especiales</li>
                                <li>â€¢ Soporte prioritario</li>
                            </ul>
                        </div>
                        <div class="glass p-6 relative overflow-hidden">
                            <div class="absolute -right-6 -top-6 w-24 h-24 bg-gradient-to-br from-purple-600 to-cyan-400 rotate-45"></div>
                            <h3 class="text-lg font-semibold mb-4 text-gray-200">Cliente Plata</h3>
                            <ul class="text-sm text-gray-300 space-y-2">
                                <li>â€¢ 2 puntos por cada S/10 en compras</li>
                                <li>â€¢ 5% de descuento en todas las compras</li>
                                <li>â€¢ Acceso anticipado a nuevos productos</li>
                                <li>â€¢ Soporte VIP</li>
                            </ul>
                        </div>
                        <div class="glass p-6 relative overflow-hidden">
                            <div class="absolute -right-6 -top-6 w-24 h-24 bg-gradient-to-br from-yellow-600 to-yellow-400 rotate-45"></div>
                            <h3 class="text-lg font-semibold mb-4 text-gray-200">Cliente Oro</h3>
                            <ul class="text-sm text-gray-300 space-y-2">
                                <li>â€¢ 3 puntos por cada S/10 en compras</li>
                                <li>â€¢ 10% de descuento en todas las compras</li>
                                <li>â€¢ Acceso exclusivo a ofertas especiales</li>
                                <li>â€¢ Soporte VIP 24/7</li>
                                <li>â€¢ GarantÃ­a extendida</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- Legal Information -->
                <section class="max-w-6xl mx-auto px-4 py-12 border-t border-white/6">
                    <div class="grid md:grid-cols-3 gap-6 text-sm text-gray-300">
                        <div>
                            <h3 class="font-semibold mb-4">GarantÃ­a</h3>
                            <p>Todas nuestras cuentas incluyen garantÃ­a de funcionamiento. En caso de cualquier problema, proporcionamos reemplazo inmediato sin costo adicional.</p>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-4">TÃ©rminos y Condiciones</h3>
                            <p>Al realizar una compra, aceptas nuestros tÃ©rminos y condiciones. Las cuentas son para uso personal y no se permite su reventa.</p>
                        </div>
                        <div>
                            <h3 class="font-semibold mb-4">Privacidad</h3>
                            <p>Protegemos tu informaciÃ³n personal y no la compartimos con terceros. Tus datos estÃ¡n seguros con nosotros.</p>
                        </div>
                    </div>
                </section>

				<footer class="py-8 text-center text-sm text-gray-400">
					Â© <span id="year"></span> Xoldyx Store 
				</footer>

		<script>
			// Config
			const WHATSAPP_NUMBERS = {
				'Streaming': '51923499080',
				'MÃ©todos': '51934920256',
				'Cursos': '51934920256'
			};
			const formatter = new Intl.NumberFormat('es-PE',{style:'currency',currency:'PEN'});

            // Loyalty Program Config
            const LOYALTY_LEVELS = {
                normal: { name: 'Normal', pointsMultiplier: 1, discount: 0 },
                silver: { name: 'Plata', pointsMultiplier: 2, discount: 0.05, minPoints: 100 },
                gold: { name: 'Oro', pointsMultiplier: 3, discount: 0.10, minPoints: 300 }
            };

            // Product Availability (simulado)
            const STOCK_STATUS = {
                high: 'En stock',
                low: 'Ãšltimas unidades',
                out: 'Agotado'
            };

			// Theme config
			const THEMES = {
				dark: { bg: '#05060a', text: '#e6eef8', glass: 'rgba(255,255,255,0.02)' },
				light: { bg: '#ffffff', text: '#1a1a1a', glass: 'rgba(0,0,0,0.02)' }
			};

			// Sistema mejorado de cupones y almacenamiento
			const STORAGE_KEYS = {
				COUPONS: 'xoldyx_cupones',
				CART: 'xoldyx_cart',
				ADMIN: 'xoldyx_admin',
				NOTIFICATIONS: 'xoldyx_notifications',
				SETTINGS: 'xoldyx_settings'
			};

			// Comprobar y limpiar almacenamiento local si es necesario
			function initializeStorage() {
				try {
					const keys = Object.values(STORAGE_KEYS);
					for (let key of keys) {
						const data = localStorage.getItem(key);
						if (data === null) continue;
						
						// Verificar que el JSON sea vÃ¡lido
						JSON.parse(data);
					}
				} catch (e) {
					console.warn('Reiniciando almacenamiento local debido a datos invÃ¡lidos');
					for (let key of Object.values(STORAGE_KEYS)) {
						localStorage.removeItem(key);
					}
				}
			}

			function getCoupons() {
				try {
					const coupons = JSON.parse(localStorage.getItem(STORAGE_KEYS.COUPONS)) || [];
					const validCoupons = {};
					const now = new Date();

					coupons.forEach(coupon => {
						const expiryDate = new Date(coupon.expiry);
						if (expiryDate > now) {
							validCoupons[coupon.code] = {
								discount: parseInt(coupon.discount),
								description: `${coupon.discount}% de descuento`,
								expiry: coupon.expiry,
								createdAt: coupon.createdAt
							};
						}
					});
					return validCoupons;
				} catch(e) {
					console.warn('Error loading coupons:', e);
					return {};
				}
			}

			// FunciÃ³n para validar un cupÃ³n
			function validateCoupon(code) {
				const coupons = getCoupons();
				const coupon = coupons[code.toUpperCase()];
				
				if (!coupon) {
					return { valid: false, message: 'CupÃ³n no vÃ¡lido' };
				}

				const now = new Date();
				const expiryDate = new Date(coupon.expiry);
				
				if (expiryDate < now) {
					return { valid: false, message: 'CupÃ³n expirado' };
				}

				return { 
					valid: true, 
					coupon: {
						...coupon,
						code: code.toUpperCase()
					}
				};
			}

			// Sistema de puntos
			const POINTS_PER_CURRENCY = 0.1; // 0.1 puntos por cada sol
			let userPoints = parseInt(localStorage.getItem('xoldyx_points')) || 0;

			// Productos solicitados
			const products = [
				// Streaming
				{id:'netflix', name:'Netflix', category:'Streaming', variants:{'Perfil':12,'Cuenta Completa':35}},
				{id:'disney', name:'Disney+', category:'Streaming', variants:{'Perfil':6,'Cuenta Completa':25}},
				{id:'hbo', name:'HBO Max', category:'Streaming', variants:{'Perfil':8,'Cuenta Completa':25}},
				{id:'prime', name:'Prime Video', category:'Streaming', variants:{'Perfil':7,'Cuenta Completa':25}},
				{id:'paramount', name:'Paramount+', category:'Streaming', variants:{'Perfil':5,'Cuenta Completa':20}},
				{id:'crunchyroll', name:'Crunchyroll', category:'Streaming', variants:{'Perfil':4,'Cuenta Completa':25}},
				{id:'vix', name:'Vix+', category:'Streaming', variants:{'Perfil':3,'Cuenta Completa':20}},
				{id:'deezer', name:'Deezer', category:'Streaming', variants:{'Perfil':5,'Cuenta Completa':20}},
				{id:'expressvpn', name:'ExpressVPN', category:'Streaming', variants:{'Cuenta Completa':40}},
				{id:'chatgpt', name:'ChatGPT', category:'Streaming', variants:{'Perfil':18}},
				{id:'doxeo', name:'doxeo', category:'Streaming', variants:{'Acceso al mÃ©todo':30}},
				{id:'Office anual', name:'Office anual', category:'Streaming', variants:{'Acceso al mÃ©todo':50}},
				{id:'canva', name:'Canva', category:'Streaming', variants:{'Canva 1 mes ':5,'Canva anual':10}},
				{id:'youtube', name:'YouTube', category:'Streaming', variants:{'Cuenta Completa':10}},
				{id:'gemini', name:'Gemini Pro', category:'Streaming', variants:{'Cuenta Completa':20}},
				{id:'panel-canva', name:'Panel Canva', category:'Streaming', variants:{'Acceso al mÃ©todo':15}},
				{id:'vix-links', name:'Vix+ (links)', category:'Streaming', variants:{'Acceso al mÃ©todo':10}},
				{id:'appletv', name:'Apple TV', category:'Streaming', variants:{'cuenta completa':10}},
				// Cursos
				{id:'curso-metodos', name:'Curso Xoldyx + 30 MÃ©todos Vip', category:'Cursos', variants:{'Acceso VIP':50}},

				// MÃ©todos
				{id:'metodo-vix', name:'MÃ©todo de Vix+', category:'MÃ©todos', variants:{'Acceso al mÃ©todo':15}},
				{id:'metodo-apple', name:'MÃ©todo de Apple TV', category:'MÃ©todos', variants:{'Acceso al mÃ©todo':30}},
				{id:'metodo-crunchyroll', name:'MÃ©todo de Crunchyroll', category:'MÃ©todos', variants:{'Acceso al mÃ©todo':30}},
				{id:'metodo-deezer', name:'MÃ©todo de Deezer', category:'MÃ©todos', variants:{'Acceso al mÃ©todo':10}},
				{id:'metodo-youtube', name:'MÃ©todo de YouTube', category:'MÃ©todos', variants:{'Acceso al mÃ©todo':35}},
				{id:'metodo-hbo', name:'MÃ©todo de HBO Max', category:'MÃ©todos', variants:{'Acceso al mÃ©todo':350}},
			];

			const imageMap = {
				'curso-metodos':'https://api.iconify.design/mdi/book-open-variant.svg',
				'metodo-vix':'https://api.iconify.design/mdi/book-education.svg',
				'metodo-apple':'https://api.iconify.design/mdi/apple.svg',
				'metodo-crunchyroll':'https://api.iconify.design/mdi/school.svg',
				'metodo-deezer':'https://api.iconify.design/mdi/music-education.svg',
				'metodo-youtube':'https://api.iconify.design/mdi/youtube.svg',
				'metodo-hbo':'https://api.iconify.design/mdi/video-education.svg',
				'crunchyroll':'https://api.iconify.design/logos/crunchyroll.svg',
				'netflix':'https://www.svgrepo.com/svg/303341/netflix-1-logoo.svg',
				'crunchyroll':'https://api.iconify.design/logos/crunchyroll.svg',
				'disney':'https://api.iconify.design/simple-icons/disneyplus.svg',
				'hbo':'https://api.iconify.design/simple-icons/max.svg',
				'paramount':'https://api.iconify.design/simple-icons/paramountplus.svg',
				'chatgpt':'https://api.iconify.design/simple-icons/openai.svg',
				'youtube':'https://api.iconify.design/logos/youtube-icon.svg',
				'canva-anual':'https://api.iconify.design/logos/canva.svg',
				'panel-canva':'https://api.iconify.design/logos/canva.svg',
				'gemini':'https://api.iconify.design/simple-icons/googlegemini.svg',
				'Prime':'https://api.iconify.design/simple-icons/primevideo.svg',
				'vix-links':'https://api.iconify.design/simple-icons/vix.svg',
				'vix':'https://api.iconify.design/simple-icons/vix.svg',
				'deezer':'https://api.iconify.design/logos/deezer-icon.svg',
				'expressvpn':'https://api.iconify.design/simple-icons/expressvpn.svg',
				'doxeo':'https://api.iconify.design/mdi/account-search.svg'
			};

						// State
						const state = { cart: [] };
						// Product overrides (image URL and link) saved in localStorage
						const productOverrides = {};
						function loadOverrides(){ try{ const raw = localStorage.getItem('xoldyx_overrides'); if(raw){ Object.assign(productOverrides, JSON.parse(raw)); } }catch(e){console.warn(e);} }
						function saveOverrides(){ try{ localStorage.setItem('xoldyx_overrides', JSON.stringify(productOverrides)); }catch(e){console.warn(e);} }

						let EDIT_MODE = false;

						// Persistence: load/save cart to localStorage
						function loadCart(){
							try{
								const raw = localStorage.getItem('xoldyx_cart');
								if(raw){ state.cart = JSON.parse(raw); }
							}catch(e){ console.warn('loadCart failed', e); }
						}
						function saveCart(){
							try{ localStorage.setItem('xoldyx_cart', JSON.stringify(state.cart)); }catch(e){ console.warn('saveCart failed', e); }
						}

						// Helpers
						const el = s => document.querySelector(s);

						// Try local image alternatives: .png, .webp, .jpg, .svg then fallback
						function tryNextImage(imgEl, basePath, idx, fallback){
							const exts = ['.png','.webp','.jpg','.svg'];
							if(idx < exts.length){
								imgEl.onerror = function(){ tryNextImage(imgEl, basePath, idx+1, fallback); };
								imgEl.src = basePath + exts[idx];
							}else{
								// final fallback
								if(fallback){ imgEl.onerror = null; imgEl.src = fallback; } else { imgEl.onerror = null; imgEl.src='imagenes/placeholder.png'; }
							}
						}

						// Render 'Cuentas' submenu: list all products for quick access (global)
						function renderAccountsMenu(){
							const sub = document.getElementById('accountsSubmenu');
							if(!sub) return;
							sub.innerHTML = '';
							products.forEach(p=>{
								const a = document.createElement('a');
								a.href = '#';
								a.textContent = p.name;
								a.addEventListener('click', (e)=>{
									e.preventDefault();
									document.getElementById('search').value = p.name;
									document.getElementById('filterCategory').value = p.category;
									renderProducts();
									sub.classList.remove('show');
								});
								sub.appendChild(a);
							});
						}

						// Audio background
						const bgAudio = document.createElement('audio'); bgAudio.id='bgAudio'; bgAudio.loop=true; bgAudio.src='videos/music.mp3'; bgAudio.preload='auto'; document.body.appendChild(bgAudio);
						let AUDIO_ENABLED = false;
						function tryAutoplayAudio(){
							const saved = localStorage.getItem('xoldyx_audio');
							if(saved==='on'){ AUDIO_ENABLED = true; bgAudio.play().catch(()=>{ AUDIO_ENABLED=false; }); }
						}
						function toggleAudio(){ if(bgAudio.paused){ bgAudio.play().then(()=>{ AUDIO_ENABLED=true; localStorage.setItem('xoldyx_audio','on'); el('#audioToggle').textContent='â¸ï¸Ž MÃºsica'; }).catch(()=>{ AUDIO_ENABLED=false; alert('Autoplay bloqueado por el navegador. Pulsa para reproducir.'); }); } else { bgAudio.pause(); AUDIO_ENABLED=false; localStorage.setItem('xoldyx_audio','off'); el('#audioToggle').textContent='â–¶ï¸Ž MÃºsica'; } }

					function renderProducts(){
				const q = (el('#search').value||'').toLowerCase();
				const cat = el('#filterCategory').value;
				const list = products.filter(p=>{
					const matchQ = (p.name+' '+p.category).toLowerCase().includes(q);
					const matchC = !cat || p.category===cat;
					return matchQ && matchC;
				});

						el('#productsGrid').innerHTML = list.map((p,i)=>{
					const variants = Object.entries(p.variants);
					const firstPrice = variants[0][1];
							    const override = productOverrides[p.id] || {};
							    // prefer override image, then local `imagenes/{id}.png`, then imageMap
							    const localCandidate = `imagenes/${p.id}.png`;
							    let imgSrc = override.image || localCandidate || imageMap[p.id] || '';
										const prodLink = override.link || '';
							    return `
																<div class="product-card glass p-5 animate-fade" style="animation-delay:${i*60}ms">
									<img src="${imgSrc}" alt="${p.name}" class="product-img mx-auto mb-4" onerror="(function(el,id,fallback){ if(el.src.indexOf('imagenes/')===-1){ el.onerror=null; tryNextImage(el,'imagenes/'+id,0,fallback); } })(this,'${p.id}','${imageMap[p.id]||''}')" />
														<h3 class="text-lg font-semibold mb-1">${ prodLink ? `<a href="${prodLink}" target="_blank" class="underline">${p.name}</a>` : p.name }</h3>
														<div class="text-sm muted mb-2">${p.category}</div>
														<div class="mb-3 text-sm muted">Desde <strong>${formatter.format(firstPrice)}</strong></div>
														${ EDIT_MODE ? `
															<div class="space-y-2 mb-3">
																<input id="imgurl-${p.id}" placeholder="URL de imagen" value="${override.image||''}" class="w-full bg-[#071024] border border-white/6 rounded-xl px-3 py-2 text-sm" />
																<input id="link-${p.id}" placeholder="Enlace del producto (opcional)" value="${override.link||''}" class="w-full bg-[#071024] border border-white/6 rounded-xl px-3 py-2 text-sm" />
																<div class="flex gap-2">
																	<button class="w-full py-2 rounded-xl bg-green-600 text-black font-semibold" onclick="saveOverride('${p.id}')">Guardar</button>
																	<button class="w-full py-2 rounded-xl bg-red-600 text-black font-semibold" onclick="clearOverride('${p.id}')">Borrar</button>
																</div>
															</div>
														` : `
															<div class="flex gap-2">
																<select id="variant-${p.id}" class="flex-1 bg-[#071024] border border-white/6 rounded-xl px-3 py-2 text-sm">
																	${variants.map(([v,price])=>`<option value="${v}">${v} â€” ${formatter.format(price)}</option>`).join('')}
																</select>
																<input id="qty-${p.id}" type="number" value="1" min="1" class="w-20 bg-[#071024] border border-white/6 rounded-xl px-3 py-2 text-sm" />
															</div>
															<button class="mt-3 w-full py-2 rounded-xl accent-btn text-black font-semibold" onclick="addToCartById('${p.id}')">Agregar</button>
														`}
												</div>
										`;
				}).join('');
			}

					/* Carousel logic */
					let carouselIndex = 0;
					let carouselTimer = null;

					function renderCarousel(){
						const track = el('#carouselTrack');
						// Seleccionar productos destacados especÃ­ficos
						const destacados = products.filter(p => ['curso-metodos', 'netflix', 'expressvpn', 'doxeo-premium', 'metodo-youtube'].includes(p.id));
						track.innerHTML = destacados.map(p=>`
							<div class="carousel-item glass p-4">
								<div class="relative overflow-hidden rounded-xl group">
									<img src="imagenes/${p.id}.png" 
										alt="${p.name}" 
										class="product-img mx-auto mb-2 transform transition-transform group-hover:scale-110" 
										onerror="tryNextImage(this, 'imagenes/${p.id}', 0, '${imageMap[p.id]||''}')" />
									<div class="absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity">
										<div class="font-semibold text-white">${p.name}</div>
										<div class="text-xs text-emerald-400">${p.category}</div>
										<div class="mt-2 text-sm text-white">${Object.entries(p.variants)[0][0]} â€” <strong>${formatter.format(Object.entries(p.variants)[0][1])}</strong></div>
									</div>
								</div>
							</div>
						`).join('');

						// compute item width dynamically
						requestAnimationFrame(()=>{
							const first = track.querySelector('.carousel-item');
							if(first){
								const gap = parseInt(getComputedStyle(track).gap) || 12;
								const w = Math.round(first.getBoundingClientRect().width + gap);
								track.dataset.itemWidth = w;
							}
							updateCarousel();
							startCarousel(); // Iniciar automÃ¡ticamente
						});

						// add hover pause and touch handlers
						const carouselEl = el('#carousel');
						if(carouselEl && !carouselEl.dataset.handlers){
							carouselEl.dataset.handlers = '1';
							
							// Pausar en hover
							carouselEl.addEventListener('mouseenter', ()=>{ 
								if(carouselTimer) clearInterval(carouselTimer); 
							});
							
							// Reanudar al salir
							carouselEl.addEventListener('mouseleave', ()=>{ 
								startCarousel(); 
							});

							// touch swipe
							let startX = 0;
							let isDragging = false;
							
							carouselEl.addEventListener('touchstart', e=>{ 
								startX = e.touches[0].clientX;
								isDragging = true;
								if(carouselTimer) clearInterval(carouselTimer);
							});
							
							carouselEl.addEventListener('touchmove', e=>{ 
								if(!isDragging) return;
								const dx = e.touches[0].clientX - startX;
								const track = el('#carouselTrack');
								const itemWidth = parseInt(track.dataset.itemWidth) || 252;
								const currentOffset = -(carouselIndex * itemWidth);
								track.style.transform = `translateX(${currentOffset + dx}px)`;
							});
							
							carouselEl.addEventListener('touchend', e=>{ 
								isDragging = false;
								const dx = e.changedTouches[0].clientX - startX;
								if(Math.abs(dx) > 40){ 
									if(dx < 0) nextCarousel(); 
									else prevCarousel(); 
								} else {
									updateCarousel(); // Volver a la posiciÃ³n original si el swipe fue muy corto
								}
								startCarousel(); 
							});
						}
					}

					function updateCarousel(){
						const track = el('#carouselTrack');
						const itemWidth = parseInt(track.dataset.itemWidth) || 252;
						track.style.transform = `translateX(-${carouselIndex * itemWidth}px)`;
						
						// Actualizar indicadores de navegaciÃ³n
						const buttons = track.parentElement.querySelectorAll('.carousel-nav button');
						buttons.forEach((btn, idx) => {
							btn.classList.toggle('bg-emerald-500/50', idx === carouselIndex);
						});
					}

					function nextCarousel(){ 
						const track = el('#carouselTrack');
						const items = track.querySelectorAll('.carousel-item');
						carouselIndex = (carouselIndex + 1) % items.length;
						
						// Asegurar animaciÃ³n suave
						track.style.transition = 'transform 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
						updateCarousel();
						
						// Reiniciar el carrusel si llega al final
						if (carouselIndex === items.length - 1) {
							setTimeout(() => {
								track.style.transition = 'none';
								carouselIndex = 0;
								updateCarousel();
								setTimeout(() => {
									track.style.transition = 'transform 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
								}, 50);
							}, 800);
						}
					}

					function prevCarousel(){ 
						carouselIndex = Math.max(0, carouselIndex-1);
						const track = el('#carouselTrack');
						track.style.transition = 'transform 0.5s ease-in-out';
						updateCarousel();
					}

					function startCarousel(){
						if(carouselTimer) clearInterval(carouselTimer);
						// Iniciar inmediatamente con la primera transiciÃ³n
						nextCarousel();
						// Establecer el intervalo para las siguientes transiciones
						carouselTimer = setInterval(()=>{ 
							nextCarousel();
						}, 3000); // RotaciÃ³n cada 3 segundos
						
						// Agregar log para debug
						console.log('Carrusel iniciado');
					}


			function addToCartById(id){
				const p = products.find(x=>x.id===id);
				const variantSel = el(`#variant-${id}`);
				const qtyEl = el(`#qty-${id}`);
				const variant = variantSel ? variantSel.value.split(' â€” ')[0] : Object.keys(p.variants)[0];
				const qty = qtyEl ? Math.max(1,parseInt(qtyEl.value)||1) : 1;
				addToCart(p,variant,qty);
			}

			function addToCart(p, variant, qty){
				const price = p.variants[variant];
				const key = `${p.id}__${variant}`;
				const found = state.cart.find(i=>i.key===key);
				if(found) found.qty += qty; else state.cart.push({key,id:p.id,name:p.name,variant,price,qty});
				updateCartUI();
				openCart();
			}

			function updateCartUI(){
				const list = el('#cartList');
				const count = state.cart.reduce((a,b)=>a+b.qty,0);
				const cartCountEl = el('#cartCount');
				cartCountEl.textContent = count;
				// bump animation
				cartCountEl.classList.remove('bump'); void cartCountEl.offsetWidth; cartCountEl.classList.add('bump');
				if(state.cart.length===0){ list.innerHTML = '<p class="text-sm muted">Tu carrito estÃ¡ vacÃ­o.</p>'; el('#subtotal').textContent = formatter.format(0); saveCart(); return; }
				list.innerHTML = state.cart.map((item,idx)=>{
					return `
						<div class="flex items-center gap-3">
							<div class="flex-1">
								<div class="font-semibold">${item.name}</div>
								<div class="text-xs muted">${item.variant} Â· ${formatter.format(item.price)}</div>
							</div>
							<div class="flex items-center gap-2">
								<button data-idx="${idx}" class="dec px-2 py-1 bg-white/5 rounded">-</button>
								<div class="px-2">${item.qty}</div>
								<button data-idx="${idx}" class="inc px-2 py-1 bg-white/5 rounded">+</button>
								<div class="font-bold ml-4">${formatter.format(item.price*item.qty)}</div>
							</div>
						</div>
					`;
				}).join('');

				list.querySelectorAll('.dec').forEach(btn=>btn.addEventListener('click',()=>{ const i=+btn.dataset.idx; state.cart[i].qty=Math.max(1,state.cart[i].qty-1); updateCartUI(); }));
				list.querySelectorAll('.inc').forEach(btn=>btn.addEventListener('click',()=>{ const i=+btn.dataset.idx; state.cart[i].qty+=1; updateCartUI(); }));

				const subtotal = state.cart.reduce((a,b)=>a+b.price*b.qty,0);
				el('#subtotal').textContent = formatter.format(subtotal);
				saveCart();
			}

						function openCart(){ el('#cartDrawer').classList.remove('hidden'); }
						function closeCart(){ el('#cartDrawer').classList.add('hidden'); }

						// Contact modal
						function openContact() {
							el('#contactModal').classList.remove('hidden');
						}
						
						function closeContact() {
							el('#contactModal').classList.add('hidden');
						}

						// Override helpers
						function saveOverride(id){
							const img = el(`#imgurl-${id}`)?.value || '';
							const link = el(`#link-${id}`)?.value || '';
							productOverrides[id] = { image: img, link };
							saveOverrides();
							renderProducts();
						}
						function clearOverride(id){
							delete productOverrides[id];
							saveOverrides();
							renderProducts();
						}

			// Events (after DOM ready)
			// Nuevas funciones de UI/UX
			function toggleTheme() {
				const isDark = document.body.classList.toggle('light-theme');
				const theme = isDark ? THEMES.light : THEMES.dark;
				document.body.style.background = theme.bg;
				document.body.style.color = theme.text;
				localStorage.setItem('xoldyx_theme', isDark ? 'light' : 'dark');
			}

			function applyCoupon() {
				const code = el('#couponCode').value.toUpperCase();
				const coupons = getCoupons();
				const coupon = coupons[code];
				
				if (!coupon) {
					alert('CupÃ³n invÃ¡lido o expirado');
					return;
				}

				const expiryDate = new Date(coupon.expiry);
				if (expiryDate < new Date()) {
					alert('Este cupÃ³n ha expirado');
					return;
				}

				// Guardar el cupÃ³n aplicado en el estado del carrito
				state.appliedCoupon = {
					code: code,
					discount: coupon.discount,
					expiry: coupon.expiry
				};

				// Actualizar UI con el descuento
				updateCartWithDiscount();
				
				// Mostrar notificaciÃ³n de Ã©xito
				showFloatingNotification(`Â¡CupÃ³n aplicado! ${coupon.description}`, 'success');
			}

			function updateCartWithDiscount() {
				const subtotal = state.cart.reduce((a,b)=>a+b.price*b.qty,0);
				let discount = 0;
				let total = subtotal;

				if (state.appliedCoupon) {
					discount = subtotal * (state.appliedCoupon.discount / 100);
					total = subtotal - discount;
				}

				el('#subtotal').textContent = formatter.format(subtotal);
				el('#discount').textContent = `-${formatter.format(discount)}`;
				el('#total').textContent = formatter.format(total);

				// Actualizar el badge del carrito
				const cartCountEl = el('#cartCount');
				cartCountEl.textContent = state.cart.reduce((a,b)=>a+b.qty,0);
			}

			function showFloatingNotification(message, type = 'info') {
				const notification = document.createElement('div');
				notification.className = `fixed bottom-4 right-4 p-4 rounded-lg shadow-lg z-50 transition-all duration-300 transform translate-y-0 opacity-100 ${
					type === 'success' ? 'bg-emerald-500' : 
					type === 'error' ? 'bg-red-500' : 
					'bg-blue-500'
				}`;
				notification.textContent = message;

				document.body.appendChild(notification);

				// AnimaciÃ³n de entrada
				setTimeout(() => {
					notification.style.transform = 'translateY(-20px)';
				}, 100);

				// AnimaciÃ³n de salida y eliminaciÃ³n
				setTimeout(() => {
					notification.style.opacity = '0';
					notification.style.transform = 'translateY(0)';
					setTimeout(() => notification.remove(), 300);
				}, 3000);
			}

			function saveCurrentCart() {
				const cartName = prompt('Nombre para guardar el carrito:');
				if (!cartName) return;
				const savedCarts = JSON.parse(localStorage.getItem('xoldyx_saved_carts') || '{}');
				savedCarts[cartName] = state.cart;
				localStorage.setItem('xoldyx_saved_carts', JSON.stringify(savedCarts));
				alert('Carrito guardado');
			}

			function handleScroll() {
				const backToTop = el('#backToTop');
				if (window.scrollY > 300) {
					backToTop.style.opacity = '1';
				} else {
					backToTop.style.opacity = '0';
				}
			}

			function scrollToTop() {
				window.scrollTo({ top: 0, behavior: 'smooth' });
			}

            // Sistema de puntos y lealtad mejorado
            function addPoints(amount) {
                const userLevel = getUserLevel();
                const multiplier = LOYALTY_LEVELS[userLevel].pointsMultiplier;
                const pointsEarned = Math.floor(amount * POINTS_PER_CURRENCY * multiplier);
                userPoints += pointsEarned;
                localStorage.setItem('xoldyx_points', userPoints.toString());
                updateUserLevel();
                return pointsEarned;
            }

            function getUserLevel() {
                if (userPoints >= LOYALTY_LEVELS.gold.minPoints) return 'gold';
                if (userPoints >= LOYALTY_LEVELS.silver.minPoints) return 'silver';
                return 'normal';
            }

            function updateUserLevel() {
                const level = getUserLevel();
                const levelInfo = LOYALTY_LEVELS[level];
                
                // Actualizar UI con el nivel del usuario
                const userLevelEl = document.createElement('div');
                userLevelEl.className = 'fixed top-4 right-4 glass p-2 text-sm';
                userLevelEl.innerHTML = `
                    <div class="font-semibold">${levelInfo.name}</div>
                    <div class="text-xs muted">${userPoints} puntos</div>
                `;
                
                // Remover notificaciÃ³n anterior si existe
                const oldLevel = document.querySelector('.user-level-notification');
                if (oldLevel) oldLevel.remove();
                
                // Agregar nueva notificaciÃ³n
                userLevelEl.classList.add('user-level-notification');
                document.body.appendChild(userLevelEl);
                
                // Desvanecer despuÃ©s de 3 segundos
                setTimeout(() => {
                    userLevelEl.style.opacity = '0';
                    setTimeout(() => userLevelEl.remove(), 500);
                }, 3000);
            }

            // Funciones de disponibilidad
            function getProductStock(productId) {
                // SimulaciÃ³n de estado de stock
                const random = Math.random();
                if (random > 0.8) return STOCK_STATUS.low;
                if (random > 0.95) return STOCK_STATUS.out;
                return STOCK_STATUS.high;
            }

            // Sistema de reseÃ±as
            function addReview(productId, rating, comment, userName) {
                const reviews = JSON.parse(localStorage.getItem('xoldyx_reviews') || '{}');
                if (!reviews[productId]) reviews[productId] = [];
                
                reviews[productId].push({
                    rating,
                    comment,
                    userName,
                    date: new Date().toISOString()
                });
                
                localStorage.setItem('xoldyx_reviews', JSON.stringify(reviews));
                updateProductReviews(productId);
            }

			// Sistema de Notificaciones Global
			function updateNotificationsBadge() {
				const notifications = JSON.parse(localStorage.getItem('notifications') || '[]');
				const badge = el('#notificationsBadge');
				const activeNotifications = notifications.filter(n => {
					const notifDate = new Date(n.createdAt);
					const now = new Date();
					// Mostrar notificaciones de los Ãºltimos 7 dÃ­as
					const isRecent = (now - notifDate) < 7 * 24 * 60 * 60 * 1000;
					return isRecent;
				});
				
				if (activeNotifications.length > 0) {
					badge.textContent = activeNotifications.length;
					badge.classList.remove('hidden');
					// Mostrar la notificaciÃ³n mÃ¡s reciente automÃ¡ticamente
					if (!localStorage.getItem('lastNotificationShown')) {
						showLatestNotification(activeNotifications[activeNotifications.length - 1]);
					}
				} else {
					badge.classList.add('hidden');
				}
			}

			function showLatestNotification(notification) {
				const notifDiv = document.createElement('div');
				notifDiv.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 transition-all duration-500 transform translate-y-0 ${
					notification.type === 'success' ? 'bg-emerald-500' :
					notification.type === 'warning' ? 'bg-yellow-500' :
					notification.type === 'error' ? 'bg-red-500' :
					'bg-blue-500'
				}`;
				notifDiv.innerHTML = `
					<div class="flex items-start gap-2">
						<div class="flex-1">
							<h4 class="font-medium text-white">${notification.title}</h4>
							<p class="text-sm text-white/90">${notification.message}</p>
						</div>
						<button onclick="this.parentElement.parentElement.remove()" class="text-white/80 hover:text-white">âœ•</button>
					</div>
				`;
				document.body.appendChild(notifDiv);
				localStorage.setItem('lastNotificationShown', new Date().toISOString());

				// Desaparecer despuÃ©s de 5 segundos
				setTimeout(() => {
					notifDiv.style.opacity = '0';
					setTimeout(() => notifDiv.remove(), 500);
				}, 5000);
			}

			function showNotificationsModal() {
				const modal = el('#notificationsModal');
				const list = el('#notificationsModalList');
				const notifications = JSON.parse(localStorage.getItem('notifications') || '[]');
				
				list.innerHTML = notifications.length > 0 ? notifications.map((notif, index) => `
					<div class="p-4 glass ${notif.read ? 'opacity-75' : ''} ${getNotificationColorClass(notif.type)}">
						<div class="flex justify-between items-start">
							<div>
								<h4 class="font-medium ${notif.read ? '' : 'text-emerald-400'}">${notif.title}</h4>
								<p class="text-sm text-slate-300 mt-1">${notif.message}</p>
								<span class="text-xs text-slate-400 mt-2 block">${new Date(notif.createdAt).toLocaleString()}</span>
							</div>
							<button onclick="markNotificationAsRead(${index})" class="text-xs text-slate-400 hover:text-emerald-400">
								${notif.read ? 'LeÃ­do' : 'Marcar como leÃ­do'}
							</button>
						</div>
					</div>
				`).join('') : '<p class="text-center text-slate-400">No hay notificaciones</p>';

				modal.classList.remove('hidden');
			}

			function getNotificationColorClass(type) {
				switch(type) {
					case 'info': return 'border-l-4 border-blue-500';
					case 'success': return 'border-l-4 border-emerald-500';
					case 'warning': return 'border-l-4 border-yellow-500';
					case 'error': return 'border-l-4 border-red-500';
					default: return 'border-l-4 border-slate-500';
				}
			}

			function hideNotificationsModal() {
				el('#notificationsModal').classList.add('hidden');
			}

			function markNotificationAsRead(index) {
				const notifications = JSON.parse(localStorage.getItem('notifications') || '[]');
				if (notifications[index]) {
					notifications[index].read = true;
					localStorage.setItem('notifications', JSON.stringify(notifications));
					updateNotificationsBadge();
					showNotificationsModal(); // Actualizar la vista
				}
			}

			function showNotification(notification) {
				const notifications = JSON.parse(localStorage.getItem('notifications') || '[]');
				notification.read = false;
				notifications.push(notification);
				localStorage.setItem('notifications', JSON.stringify(notifications));
				updateNotificationsBadge();
			}

			function checkNotifications() {
				updateNotificationsBadge();
			}

			// FunciÃ³n para el botÃ³n de administrador
			function openAdminPanel() {
				window.location.href = 'admin/admin.html';
			}

			// Sistema de notificaciones mejorado
			function startNotificationCheck() {
				checkNotifications();
				
				// Comprobar nuevas notificaciones cada 5 minutos
				setInterval(checkNotifications, 5 * 60 * 1000);
				
				// Comprobar notificaciones cuando la pestaÃ±a vuelve a estar activa
				document.addEventListener('visibilitychange', () => {
					if (document.visibilityState === 'visible') {
						checkNotifications();
					}
				});
			}

			// InicializaciÃ³n de la pÃ¡gina
			document.addEventListener('DOMContentLoaded', ()=>{
				// Inicializar almacenamiento
				initializeStorage();
				// Iniciar sistema de notificaciones
				startNotificationCheck();
				
				// Agregar evento al botÃ³n de administrador
				el('#adminBtn').addEventListener('click', openAdminPanel);

				// Eventos para notificaciones
				el('#notificationsBtn').addEventListener('click', showNotificationsModal);
				el('#closeNotifications').addEventListener('click', hideNotificationsModal);
				el('#notificationsModal').querySelector('.absolute.inset-0').addEventListener('click', hideNotificationsModal);
				// Event listeners existentes
				el('#filterCategory').addEventListener('change', renderProducts);
				el('#search').addEventListener('input', renderProducts);
				el('#cartBtn').addEventListener('click', openCart);
				el('#closeCart').addEventListener('click', closeCart);
				el('#backdrop').addEventListener('click', closeCart);

				// Contact modal handlers
				el('#contactBtn').addEventListener('click', openContact);
				el('#closeContact').addEventListener('click', closeContact);
				el('#contactModal').querySelector('.absolute.inset-0').addEventListener('click', closeContact);

				// Nuevos event listeners
				el('#sortProducts').addEventListener('change', renderProducts);
				el('#minPrice').addEventListener('input', renderProducts);
				el('#maxPrice').addEventListener('input', renderProducts);
				el('#themeToggle').addEventListener('click', toggleTheme);
				el('#backToTop').addEventListener('click', scrollToTop);
				window.addEventListener('scroll', handleScroll);
				el('#applyCoupon').addEventListener('click', applyCoupon);
				el('#saveCartBtn').addEventListener('click', saveCurrentCart);

			el('#waCheckout').addEventListener('click', ()=>{
					if(state.cart.length===0){ alert('Tu carrito estÃ¡ vacÃ­o.'); return; }
					
					const pay = document.querySelector('input[name="pay"]:checked')?.value || 'Yape';
					const name = el('#buyerName').value||'';
					const notes = el('#orderNotes').value||'';
					
					// Crear mensaje detallado para cada producto
					const lines = state.cart.map(i=>{
						const product = products.find(p => p.id === i.id);
						return `â–«ï¸ ${i.name} (${i.variant})\n   Cantidad: ${i.qty}\n   Precio: ${formatter.format(i.price*i.qty)}`;
					});
					
					const total = state.cart.reduce((a,b)=>a+b.price*b.qty,0);
					
					// Construir mensaje con mejor formato
					let msg = `Â¡Hola! ðŸ‘‹ Me interesa comprar lo siguiente:\n\n`;
					msg += `${lines.join('\n\n')}\n\n`;
					msg += `ðŸ’° Total: ${formatter.format(total)}\n`;
					msg += `ðŸ’³ MÃ©todo de pago: ${pay}\n`;
					
					if(name) msg += `ðŸ‘¤ Nombre: ${name}\n`;
					if(notes) msg += `ðŸ“ Notas adicionales: ${notes}\n`;
					
					// Determinar quÃ© nÃºmero usar basado en los productos en el carrito
					let useNumber = WHATSAPP_NUMBERS['Streaming']; // nÃºmero por defecto
					
					// Verificar si hay productos de MÃ©todos o Cursos
					if(state.cart.some(item => {
						const product = products.find(p => p.id === item.id);
						return product && (product.category === 'MÃ©todos' || product.category === 'Cursos');
					})) {
						useNumber = WHATSAPP_NUMBERS['MÃ©todos'];
					}
					
					// Personalizar el mensaje segÃºn la categorÃ­a
					let categoryMsg = '';
					const categories = new Set(state.cart.map(item => {
						const product = products.find(p => p.id === item.id);
						return product ? product.category : '';
					}));
					
					if (categories.has('MÃ©todos') || categories.has('Cursos')) {
						categoryMsg = '\n\nEstoy interesado en mÃ©todos/cursos. Por favor, envÃ­ame la informaciÃ³n detallada.';
					} else {
						categoryMsg = '\n\nEstoy interesado en estos servicios de streaming. Â¿PodrÃ­as darme mÃ¡s informaciÃ³n?';
					}
					
					msg += categoryMsg;
					
					const url = `https://wa.me/${useNumber}?text=${encodeURIComponent(msg)}`;
					window.open(url,'_blank');
				});

						document.getElementById('year').textContent = new Date().getFullYear();
						loadOverrides();
						loadCart();
						renderProducts();
						renderCarousel();
						// Asegurarse de que el carrusel comience a girar
						setTimeout(() => {
							startCarousel();
						}, 1000); // Iniciar despuÃ©s de 1 segundo para asegurar que todo estÃ¡ cargado
						updateCartUI();

						// render accounts submenu and wire toggle
						renderAccountsMenu();
						const accountsBtn = document.getElementById('accountsBtn');
						const accountsSub = document.getElementById('accountsSubmenu');
						if(accountsBtn && accountsSub){
							accountsBtn.addEventListener('click', (e)=>{ e.stopPropagation(); accountsSub.classList.toggle('show'); });
							// click outside closes submenu
							document.addEventListener('click', ()=>{ accountsSub.classList.remove('show'); });
						}

												// Edit mode toggle
												el('#editToggle').addEventListener('click', ()=>{
  if (!EDIT_MODE) {
    const password = prompt('Ingrese la contraseÃ±a para activar el modo ediciÃ³n:');
    if (password !== 'dvyer2002123') {
      alert('ContraseÃ±a incorrecta');
      return;
    }
    EDIT_MODE = true;
  } else {
    EDIT_MODE = false;
  }
  el('#editToggle').textContent = EDIT_MODE ? 'Salir ediciÃ³n' : 'Editar';
  renderProducts();
});

									// Audio toggle
									el('#audioToggle').addEventListener('click', ()=>{ toggleAudio(); });
									tryAutoplayAudio();

									// Buyer info persistence
									const buyerNameEl = el('#buyerName');
									const orderNotesEl = el('#orderNotes');
									try{ const bn = localStorage.getItem('xoldyx_buyer')||''; const on = localStorage.getItem('xoldyx_notes')||''; if(buyerNameEl) buyerNameEl.value = bn; if(orderNotesEl) orderNotesEl.value = on; }catch(e){}
									if(buyerNameEl) buyerNameEl.addEventListener('input', ()=>{ localStorage.setItem('xoldyx_buyer', buyerNameEl.value||''); });
									if(orderNotesEl) orderNotesEl.addEventListener('input', ()=>{ localStorage.setItem('xoldyx_notes', orderNotesEl.value||''); });

									// Clear cart handler
									el('#clearCart').addEventListener('click', ()=>{ if(confirm('Vaciar el carrito?')){ state.cart = []; saveCart(); updateCartUI(); } });

			// Carousel controls
			el('#nextCarousel').addEventListener('click', ()=>{ nextCarousel(); startCarousel(); });
			el('#prevCarousel').addEventListener('click', ()=>{ prevCarousel(); startCarousel(); });

			// animate cart drawer when opening
			const originalOpen = openCart;
			window.openCart = function(){ el('#cartDrawer').classList.remove('hidden'); el('#cartDrawer aside').classList.add('cart-slide'); }
			window.closeCart = function(){ el('#cartDrawer').classList.add('hidden'); el('#cartDrawer aside').classList.remove('cart-slide'); }
			});
		</script>
	</body>
</html>
